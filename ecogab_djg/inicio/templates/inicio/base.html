{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ecogab SPA: Arriendo de maquinaria y equipos de construcción en Santiago. Ofrecemos soluciones confiables para tu obra con los mejores precios del mercado.">
    <meta name="keywords" content="arriendo maquinaria, construcción, equipos construcción, Santiago, Chile, arriendo equipos, maquinaria pesada">
    <meta name="author" content="Ecogab SPA">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Ecogab SPA - Arriendo de Maquinaria y Equipos de Construcción">
    <meta property="og:description" content="Soluciones confiables para tu obra: Arriendo de maquinaria y equipos de construcción en Santiago. Calidad y servicio garantizado.">
    <meta property="og:image" content="{% static 'img/logo.avif' %}">
    <meta property="og:url" content="https://ecogab.cl">
    <meta name="twitter:card" content="summary_large_image">
    <title>{% block title %}Ecogab SPA{% endblock %}</title>
    <link rel="icon" href="{% static 'img/logo.avif' %}" type="image/x-icon">
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    <!-- Agregar Font Awesome para íconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header class="header">
        <nav class="navbar">
            <div class="navbar-container">
                <div class="logo">
                    <a href="{% url 'inicio' %}">
                        <img src="{% static 'img/logo.avif' %}" alt="Logotipo de Ecogab SPA" class="logo-img">
                    </a>
                </div>
                <div class="sliding-titles-container">
                    <div class="sliding-titles">
                        <div class="title">Bienvenido a Ecogab SPA</div>
                        <div class="title">Apoyamos el desarrollo de tu obra</div>
                    </div>
                </div>
                
                <button class="nav-toggle" aria-label="Abrir menú" data-count="0">
                    <i class="fas fa-bars"></i>
                </button>

                <div class="nav-menu">
                    <ul class="nav-links">
                        <li><a href="{% url 'inicio' %}" class="nav-link">Inicio</a></li>
                        <li><a href="{% url 'nosotros' %}" class="nav-link">Nosotros</a></li>
                        <li><a href="{% url 'contacto' %}" class="nav-link">Contacto</a></li>
                        <li><a href="{% url 'productos' %}" class="nav-link">Productos</a></li>
                        <li class="cart-item">
                            <a href="{% url 'ver_carrito' %}" class="nav-link cart-link">
                                <i class="fas fa-shopping-cart"></i>
                                <span class="cart-count" id="cart-count">0</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <main>
        {% block content %}{% endblock %}
    </main>

    <footer class="footer">
        <div class="footer-container">
            <div class="footer-section">
                <h3>Contacto</h3>
                <ul class="contact-info">
                    <li><i class="fas fa-phone"></i> <a href="tel:+56968446574">+56 9 6844 6574</a></li>
                    <li><i class="fas fa-phone"></i> <a href="tel:+56968446574">+56 9 7749 5644</a></li>
                    <li><i class="fas fa-envelope"></i> <a href="mailto:contacto@ecogab.cl">contacto@ecogab.cl</a></li>
                    <li><i class="fas fa-map-marker-alt"></i> Oficina Comercial: Av. la Florida 9650, Santiago, Chile</li>
                    <li><i class="fas fa-map-marker-alt"></i> Bodegas: Los Manzanos 2779, La Pintana, Chile</li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h3>Síguenos</h3>
                <div class="social-icons">
                    <a href="https://web.facebook.com/people/Ecogabcl/100063612480601/" target="_blank" rel="noopener noreferrer" aria-label="Facebook">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b8/2021_Facebook_icon.svg/2048px-2021_Facebook_icon.svg.png" alt="Facebook" width="32" height="32">
                    </a>
                    <a href="https://www.instagram.com/ecogab.cl/" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Instagram_logo_2022.svg/2048px-Instagram_logo_2022.svg.png" alt="Instagram" width="32" height="32">
                    </a>
                    <a href="https://wa.me/56968446574?text=Hola%2C%20me%20gustar%C3%ADa%20contactarlos%20desde%20la%20web." target="_blank" rel="noopener noreferrer" aria-label="WhatsApp">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/WhatsApp.svg/2048px-WhatsApp.svg.png" alt="WhatsApp" width="32" height="32">
                    </a>
                </div>
            </div>
    
            <div class="footer-section">
                <h3>Horario de Atención</h3>
                <p>Lunes a Viernes: 9:00 - 18:00</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© 2025 Ecogab SPA. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script>
        // Funciones de manejo de cookies
        function setCookie(name, value, days) {
            const expires = new Date();
            expires.setTime(expires.getTime() + days * 24 * 60 * 60 * 1000);
            document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/`;
        }
        
        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
            return null;
        }
        
        // Funciones del menú móvil
        document.querySelector('.nav-toggle').addEventListener('click', function() {
            document.querySelector('.nav-menu').classList.toggle('active');
            this.classList.toggle('active');
        });
        
        // Funciones del carrito
        function updateCartCount() {
            const cart = JSON.parse(getCookie('cart') || '[]');
            const cartCount = document.getElementById('cart-count');
            if (cartCount) {
                cartCount.textContent = cart.length;
            }
        }
        
        function addToCart(id, nombre, categoria, precio, imagen) {
            let cart = JSON.parse(getCookie('cart') || '[]');
            const existingItem = cart.find(item => item.id === id);

            if (existingItem) {
                // Si el producto ya está en el carrito, incrementamos la cantidad
                existingItem.cantidad = (existingItem.cantidad || 1) + 1;
            } else {
                // Si el producto no está en el carrito, lo añadimos
                cart.push({ id, nombre, categoria, precio, imagen, cantidad: 1 });
            }

            setCookie('cart', JSON.stringify(cart), 7);
            updateCartCount();
            loadCart();
        }
        
        function loadCart() {
            const cartItems = document.getElementById('cart-items');
            if (!cartItems) return; // Solo ejecutar en la página del carrito
            
            const cart = JSON.parse(getCookie('cart') || '[]');
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<p>No hay productos en el carrito</p>';
                return;
            }
            
            cartItems.innerHTML = cart.map(item => `
                <div class="cart-item">
                    <img src="${item.imagen}" alt="${item.nombre}" class="cart-item-image" onerror="this.src='/static/img/placeholder.png'">
                    <div class="cart-item-details">
                        <a href="/producto/${item.id}/" class="cart-item-name">${item.nombre}</a>
                        <span class="cart-item-category">${item.categoria}</span>
                    </div>
                    <div>${item.precio}</div>
                    <div class="remove-item" onclick="removeFromCart('${item.id}')">
                        <i class="fas fa-trash"></i>
                    </div>
                </div>
            `).join('');
        }
        
        function removeFromCart(id) {
            let cart = JSON.parse(getCookie('cart') || '[]');
            cart = cart.filter(item => item.id !== id);
            setCookie('cart', JSON.stringify(cart), 7);
            loadCart();
            updateCartCount();
        }
        
        function enviarPedidoWhatsApp() {
            const cart = JSON.parse(getCookie('cart') || '[]');
            if (cart.length === 0) {
                alert('El carrito está vacío');
                return;
            }
            
            let mensaje = 'Hola, me gustaría consultar por los siguientes productos:\n\n';
            cart.forEach(item => {
                mensaje += `- ${item.nombre} (${item.categoria})`;
                if (item.precio !== 'Consultar') {
                    mensaje += ` - $${item.precio}`;
                }
                mensaje += '\n';
            });
            
            const url = `https://wa.me/56968446574?text=${encodeURIComponent(mensaje)}`;
            window.open(url, '_blank');
            
            // Limpiar el carrito después de enviar
            setCookie('cart', '[]', 7);
            loadCart();
            updateCartCount();
        }
        
        // Inicialización al cargar la página
        document.addEventListener('DOMContentLoaded', function() {
            updateCartCount(); // Siempre actualizar el contador
            loadCart(); // Solo se ejecutará si existe el elemento cart-items
        });
    
    // Modifica la función updateCartCount
    function updateCartCount() {
        const cart = JSON.parse(getCookie('cart') || '[]');
        const cartCount = document.getElementById('cart-count');
        const navToggle = document.querySelector('.nav-toggle');
        
        // Actualizar el contador en el menú
        if (cartCount) {
            cartCount.textContent = cart.length;
        }
        
        // Actualizar el contador en el botón de hamburguesa
        if (cart.length > 0) {
            navToggle.classList.add('has-items');
            navToggle.setAttribute('data-count', cart.length);
        } else {
            navToggle.classList.remove('has-items');
            navToggle.removeAttribute('data-count');
        }
    }

    </script>

    <style>
        /* Estilo para redes sociales */
        .footer {
            background-color: var(--primary-color); /* O el color que desees */
            color: var(--background-color);
            padding: var(--spacing-lg) 0;
            width: 100%;
            margin-top: auto; /* Esto empuja el footer al final */
            border-top: none; /* Si había un borde superior no deseado */
        }

        .footer-container {
            background-color: var(--primary-color);
            color: var(--background-color);
            width: 100%;
            padding: 0 var(--spacing-lg);
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--spacing-lg);
        }

        .footer-section {
            background-color: var(--primary-color); /* Aseguramos el color de fondo en las secciones */
        }

        .footer-section h3 {
            color: var(--background-color);
            margin-bottom: var(--spacing-md);
            font-size: 1.2rem;
        }

        .contact-info {
            list-style: none;
            padding: 0;
        }

        .contact-info li {
            margin-bottom: var(--spacing-sm);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .contact-info a {
            color: var(--background-color);
            text-decoration: none;
            transition: color var(--transition-speed);
        }

        .contact-info a:hover {
            color: var(--secondary-color);
        }

        .footer-bottom {
            background-color: var(--primary-color); /* Aseguramos el color de fondo en el bottom */
            text-align: center;
            padding: var(--spacing-lg);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            width: 100%;
        }

        /* Mejoras para responsive */
        @media (max-width: 768px) {
            .footer-container {
                grid-template-columns: 1fr;
                text-align: center;
                gap: var(--spacing-lg);
            }

            .contact-info li {
                justify-content: center;
            }
        }

        /* Aseguramos que el body y main funcionen correctamente */
        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            margin: 0;
            font-family: var(--font-primary);
            font-size: var(--font-size-base);
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
        }

        main {
            flex: 1;
            margin-top: var(--nav-height);
            padding: var(--spacing-lg);
        }
        .social-icons {
            display: flex;
            justify-content: left; /* Alineación por defecto */
            gap: 15px;
            margin-top: 10px;
        }

        .social-icons a img {
            transition: transform 0.3s ease;
        }

        .social-icons a img:hover {
            transform: scale(1.1);
        }

        /* Ajustes para dispositivos móviles */
        @media (max-width: 768px) {
            .social-icons {
                justify-content: center; /* Centra los iconos en dispositivos pequeños */
                width: 100%; /* Asegura que ocupe todo el ancho disponible */
            }
        }
        
        .sliding-titles-container {
            height: 60px; /* Ajusta según el tamaño que necesites */
            overflow: hidden;
            margin: 10px 1px;
            border-radius: 4px;
            box-shadow: 0 0px 0px rgba(0,0,0,0.1);
            margin-top:0px;
            padding: 0; /* Asegúrate de no tener relleno */

        }

        .sliding-titles {
            display: flex;
            flex-direction: column;
            animation: slide 6s infinite;
            margin: 0;
        }

        .title {
            height: 60px; /* Debe coincidir con el contenedor */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: calc(1.5vw);
            font-style: italic;
            font-weight: bold;
            color: #2c3e50;
            text-align: center;
            width: auto;
            margin: 0;
        }

        @keyframes slide {
            0%, 45% {
                transform: translateY(0);
            }
            50%, 95% {
                transform: translateY(-60px); /* Debe coincidir con la altura del título */
            }
            100% {
                transform: translateY(0);
            }
        }

        /* Ajuste responsive */
        @media (max-width: 768px) {
            .title {
                font-size: 20px;
            }
        }
        .cart-item {
            display: flex;
            align-items: center;
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: #e74c3c;
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 0.8rem;
            min-width: 18px;
        }

        .add-to-cart-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 18px 24px;
            background-color: #2ecc71;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            font-size: 15px;
            display: flex;
            align-items: center;
            justify-content: center; /* Centra el contenido (texto y icono) dentro del botón */
            text-align: center; 
        }

        .add-to-cart-btn:hover {
            background-color: #27ae60;
            transform: scale(1.05);
        }

        .cart-link {
            position: relative;
            display: inline-flex;
            align-items: center;
            padding: 0.5rem var(--spacing-md);
        }
        @media (max-width: 768px) {
            .nav-menu {
                position: fixed;
                top: var(--nav-height); /* Asumiendo que tienes definida esta variable */
                left: 0;
                width: 100%;
                height: calc(100vh - var(--nav-height));
                background-color: var(--background-color);
                display: none;
                z-index: 1000;
            }

            .nav-menu.active {
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .nav-links {
                width: 100%;
                display: flex;
                flex-direction: column;
                align-items: center;
                padding: 0;
                margin: 0;
            }

            .nav-links li {
                width: 100%;
                text-align: center;
                margin: 1rem 0;
            }

            .nav-links .nav-link {
                display: block;
                padding: 1rem 0;
                width: 100%;
            }
        }
        .cart-link {
            position: relative;
            display: inline-flex;
            align-items: center;
            padding: 0.5rem;
            justify-content: center;
        }

        /* Ajuste del contador del carrito */
        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: #e74c3c;
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 0.8rem;
            min-width: 18px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @media (max-width: 768px) {
            .cart-item {
                position: relative;
                width: 100%;
                display: flex;
                justify-content: center;
            }

            .cart-link {
                position: relative;
                display: flex;
                justify-content: center;
                align-items: center;
                padding: 1rem;
                width: 100%;
            }

            .cart-count {
                position: absolute;
                top: 8px;  /* Ajustado para mejor alineación */
                right: 45%;  /* Centrado respecto al contenedor */
                transform: translateX(10px);  /* Ajuste fino de la posición */
                background-color: #e74c3c;
                color: white;
                border-radius: 50%;
                padding: 2px 6px;
                font-size: 0.8rem;
                min-width: 18px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            /* Aseguramos que el ícono del carrito esté centrado */
            .cart-link .fas.fa-shopping-cart {
                margin: 0 auto;
            }
        }
        @media (max-width: 768px) {
            .nav-toggle {
                position: relative;
                align-items: center;
                justify-content: center;
            }

            /* Estilo para el contador en el botón de hamburguesa */
            .nav-toggle::after {
                content: attr(data-count);
                position: absolute;
                top: -10px;
                right: -10px;
                background-color: #e74c3c;
                color: white;
                border-radius: 50%;
                padding: 5px 2px;
                font-size: 0.8rem;
                min-width: 18px;
                height: 18px;
                display: flex;
                align-items: center;
                justify-content: center;
                transform: translate(30%, -30%);
                /* Solo mostrar si hay items */
                display: none;
            }

            .nav-toggle.has-items::after {
                display: flex;
            }
        }
        
    </style>
</body>
</html>
